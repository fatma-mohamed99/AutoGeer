<div class="container mt-4">
  <div *ngIf="favoriteProducts$ | async as favoriteProducts">
    <ng-container *ngIf="favoriteProducts.length > 0; else noFavorites">
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        <div class="col mb-4" *ngFor="let product of favoriteProducts">
          <div class="card h-100">
            <img [src]="product?.image" class="card-img-top product-image" [alt]="product?.title">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ product?.title }}</h5>
              <p class="card-text">Price: &dollar;{{ product?.price }}</p>
              <div class="mt-auto">
                <button type="button" class="btn btn-primary btn-sm w-100 mb-2" (click)="addToCart(product)">
                  <i class="fa-solid fa-cart-plus me-2"></i> Add to Cart
                </button>
                <button type="button" class="btn btn-outline-primary btn-sm w-100 mb-2" (click)="handleData(product._id)">
                  <i class="fa-solid fa-eye me-2"></i> View Details
                </button>
                <button class="btn btn-link btn-sm p-0 favorite-btn" (click)="toggleFavorite(product)" 
                        title="{{ isFavorite(product) ? 'Remove from Favorites' : 'Add to Favorites' }}">
                  <i class="fa-solid fa-heart" [ngClass]="{'text-danger': isFavorite(product), 'text-muted': !isFavorite(product)}"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-template #noFavorites>
      <div class="text-center h-100">
        <div class="p-4 rounded shadow-sm" style="background-color: rgba(255, 255, 255, 0.8); display: inline-block;">
          <p class="h5 text-dark">No favorite items yet.</p>
          <div class="d-flex justify-content-center mb-3">
            <img src="addf.jpg" class="img-fluid rounded" alt="No favorites" style="max-height: 200px;">
          </div>
          <a href="/products" class="btn btn-primary">Browse Products</a>
        </div>
      </div>
    </ng-template>
  </div>
</div>
